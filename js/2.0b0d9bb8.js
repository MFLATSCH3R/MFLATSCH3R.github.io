(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[2],{"20b4":function(e,t,c){},"2c0b":function(e,t,c){"use strict";var n=c("20b4"),o=c.n(n);o.a},"8b24":function(e,t,c){"use strict";c.r(t);var n=function(){var e=this,t=e.$createElement,c=e._self._c||t;return c("q-page",{staticClass:"flex flex-center"},[c("ol-map")],1)},o=[],r=function(){var e=this,t=e.$createElement,c=e._self._c||t;return c("div",{attrs:{id:"ol-map"}},[c("q-page-sticky",{staticClass:"front",attrs:{position:"bottom-right",offset:[18,18]}},[c("q-btn",{attrs:{round:"",color:e.colorClass,icon:"location_on"},on:{click:e.toggleTracking}}),c("q-dialog",{model:{value:e.popupVisible,callback:function(t){e.popupVisible=t},expression:"popupVisible"}},[c("q-card",{staticClass:"my-card"},[c("q-card-section",[c("div",{staticClass:"text-h6"},[e._v("Fund")])]),c("q-separator",{attrs:{dark:""}}),c("q-card-section",[c("div",{staticClass:"q-gutter-md"},[c("q-select",{attrs:{outlined:"",label:"Pilzart",options:e.options},model:{value:e.occurrence.fungus,callback:function(t){e.$set(e.occurrence,"fungus",t)},expression:"occurrence.fungus"}}),c("q-input",{attrs:{outlined:"",type:"textarea"},model:{value:e.occurrence.description,callback:function(t){e.$set(e.occurrence,"description",t)},expression:"occurrence.description"}})],1),c("q-input",{attrs:{label:"X",dense:"",disable:"",readonly:""},model:{value:e.occurrence.coordinates.x,callback:function(t){e.$set(e.occurrence.coordinates,"x",t)},expression:"occurrence.coordinates.x"}}),c("q-input",{attrs:{label:"Y",dense:"",disable:"",readonly:""},model:{value:e.occurrence.coordinates.x,callback:function(t){e.$set(e.occurrence.coordinates,"x",t)},expression:"occurrence.coordinates.x"}})],1),c("q-separator",{attrs:{dark:""}}),c("q-card-actions",[c("q-btn",{attrs:{flat:""},on:{click:function(t){e.popupVisible=!e.popupVisible}}},[e._v("Abbrechen")]),c("q-btn",{attrs:{flat:""},on:{click:e.saveOccurrence}},[e._v("Speichern")])],1)],1)],1)],1)],1)},a=[],i=(c("a4d3"),c("e01a"),c("d81d"),c("ec26")),s=(c("5bc0"),c("5eee")),u=c("a2c7"),l=c("4cdf"),d=c("6c77"),p=c("ce2c"),g=c("83a6"),h=c("8682"),f=c("6cbf"),m=c("f403"),b=c("480c"),k=c("3e6b"),v=c("d0e9"),y=c("5831"),w=c("256f"),x={name:"Map",data:function(){return{popupVisible:!1,options:["Morchel","Pfifferling","Semmelstoppelpilz","Steinpilz","Schweinsohr"],occurrence:{uuid:null,fungus:"",description:"",date:null,coordinates:{x:null,y:null}},x:"",y:"",alt:"",tracking:{active:!1,color:"accent",options:{enableHighAccuracy:!0,timeout:1/0,maximumAge:0}}}},mounted:function(){this.initMap(),this.getCurrentPosition(),this.loadSavedOccurrences()},methods:{initMap:function(){this.map=new s["a"]({target:"ol-map",layers:[],view:new u["a"]({center:Object(w["d"])([13,47]),zoom:15})}),this.addLayers(),this.getCurrentPosition(),this.registerPressEvent()},registerPressEvent:function(){var e,t,c=this,n=500,o=!1;this.map.on("singleclick",(function(e){if(!0===o){c.popupVisible=!0;var t=Object(w["n"])(e.coordinate,"EPSG:3857","EPSG:4326");c.occurrence.coordinates.x=t[0],c.occurrence.coordinates.y=t[1]}})),this.map.on("pointerdown",(function(){e=(new Date).getTime()})),this.map.on("pointerup",(function(){t=(new Date).getTime();var c=t-e;o=c>n}))},addLayers:function(){var e=new b["a"]({source:new v["a"],zIndex:100});this.map.addLayer(e),this.occurrenceLayer=new k["a"]({source:new y["a"],style:this.getIconStyle(),zIndex:300}),this.map.addLayer(this.occurrenceLayer),this.markerLayer=new k["a"]({source:new y["a"]({features:[]}),style:new d["b"]({image:new p["a"]({radius:12,fill:new g["a"]({color:"rgba(204,0,204,0.20)"}),stroke:new h["a"]({color:"rgb(204,0,204)",width:2})})}),zIndex:900,visible:!0}),this.map.addLayer(this.markerLayer)},goToLocation:function(e,t){null!==e&&null!==t&&this.map.getView().setCenter(Object(w["d"])([e,t]))},getCurrentPosition:function(){var e=this;navigator.geolocation.getCurrentPosition((function(t){null!=t.coords.longitude&&null!=t.coords.latitude&&(e.addMarker(t.coords.longitude,t.coords.latitude),e.goToLocation(t.coords.longitude,t.coords.latitude),e.alt=t.coords.altitude)}),(function(e){console.log(e)}),this.tracking.options)},toggleTracking:function(){this.tracking.active?(this.stopTracking(),this.hideMarker()):(this.startTracking(),this.showMarker()),this.tracking.active=!this.tracking.active},startTracking:function(){var e=this;this.trackingId=navigator.geolocation.watchPosition((function(t){e.updateMarkerPosition(t.coords.longitude,t.coords.latitude),e.goToLocation(t.coords.longitude,t.coords.latitude)}),(function(e){console.log(e)}),this.tracking.options)},stopTracking:function(){navigator.geolocation.clearWatch(this.trackingId)},addMarker:function(e,t){var c=new m["a"](Object(w["d"])([e,t]));this.marker=new l["a"](c),this.markerLayer.getSource().addFeature(this.marker)},showMarker:function(){this.markerLayer.setVisible(!0)},hideMarker:function(){this.markerLayer.setVisible(!1)},updateMarkerPosition:function(e,t){this.marker.getGeometry().setPosition(Object(w["d"])([e,t]))},getIconStyle:function(e){return new d["b"]({image:new f["a"]({anchor:[.5,.5],anchorXUnits:"fraction",anchorYUnits:"fraction",src:this.mushroomImg(),size:[128,128],scale:.4}),zIndex:300})},saveOccurrence:function(){var e=null;e=localStorage.occurrences?JSON.parse(localStorage.getItem("occurrences")):[],this.occurrence.uuid=Object(i["a"])(),e.push(this.occurrence),localStorage.setItem("occurrences",JSON.stringify(e)),this.popupVisible=!1,this.displayOccurrence(this.occurrence),this.occurrence.uuid=Object(i["a"])(),this.occurrence.fungus="",this.occurrence.description="",this.occurrence.coordinates.x=void 0,this.occurrence.coordinates.y=void 0},loadSavedOccurrences:function(){if(localStorage.occurrences)for(var e=JSON.parse(localStorage.getItem("occurrences")),t=0;t<e.length;t++)this.displayOccurrence(e[t])},displayOccurrence:function(e){var t=new l["a"](new m["a"](Object(w["n"])([e.coordinates.x,e.coordinates.y],"EPSG:4326","EPSG:3857")));t.setStyle(this.getIconStyle("occurrence")),t.setId(e.uuid||Object(i["a"])()),this.occurrenceLayer.getSource().addFeature(t)},mushroomImg:function(){return c("de9d")}},computed:{colorClass:function(){var e=!0===this.tracking.active?"accent":"";return e}}},S=x,O=(c("2c0b"),c("2877")),P=c("de5e"),q=c("9c40"),I=c("24e8"),L=c("f09f"),C=c("a370"),M=c("eb85"),j=c("ddd8"),T=c("27f9"),V=c("4b7e"),Q=c("eebe"),z=c.n(Q),_=Object(O["a"])(S,r,a,!1,null,"048fd895",null),E=_.exports;z()(_,"components",{QPageSticky:P["a"],QBtn:q["a"],QDialog:I["a"],QCard:L["a"],QCardSection:C["a"],QSeparator:M["a"],QSelect:j["a"],QInput:T["a"],QCardActions:V["a"]});var $={name:"PageIndex",components:{"ol-map":E}},G=$,J=c("9989"),A=Object(O["a"])(G,n,o,!1,null,null,null);t["default"]=A.exports;z()(A,"components",{QPage:J["a"]})},de9d:function(e,t,c){e.exports=c.p+"img/mushroom_small.04e76448.png"}}]);